---
import PostLayout from "../../../layouts/PostLayout.astro";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
  const allPosts = await getCollection("posts");
  return allPosts.map((post) => {
    const parts = post.id.split("/");
    const locale = parts[0];
    const slug = parts.slice(1).join("/");
    return {
      params: { locale, slug },
      props: { post },
    };
  });
}

const { post } = Astro.props;
const { locale, slug } = Astro.params;
const { Content } = await render(post);
---

<PostLayout
  title={post.data.title}
  publishedAt={post.data.publishedAt}
  summary={post.data.summary}
  locale={locale}
  slug={slug}
  image={post.data.image}
>
  <Content />
</PostLayout>
